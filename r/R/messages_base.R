# Zulip REST API
#
# Powerful open source group chat 
#
# The version of the OpenAPI document: 1.0.0
# 
# Generated by: https://openapi-generator.tech

#' @docType class
#' @title MessagesBase
#'
#' @description MessagesBase Class
#'
#' @format An \code{R6Class} generator object
#'
#' @field avatar_url  character [optional]
#'
#' @field client  character [optional]
#'
#' @field content  character [optional]
#'
#' @field content_type  character [optional]
#'
#' @field display_recipient  \link{OneOfstringarray} [optional]
#'
#' @field id  integer [optional]
#'
#' @field is_me_message  character [optional]
#'
#' @field reactions  list( \link{EmojiReaction} ) [optional]
#'
#' @field recipient_id  integer [optional]
#'
#' @field sender_email  character [optional]
#'
#' @field sender_full_name  character [optional]
#'
#' @field sender_id  integer [optional]
#'
#' @field sender_realm_str  character [optional]
#'
#' @field stream_id  integer [optional]
#'
#' @field subject  character [optional]
#'
#' @field topic_links  list( \link{MessagesBaseTopicLinks} ) [optional]
#'
#' @field submessages  list( character ) [optional]
#'
#' @field timestamp  integer [optional]
#'
#' @field type  character [optional]
#'
#' @importFrom R6 R6Class
#' @importFrom jsonlite fromJSON toJSON
#' @export
MessagesBase <- R6::R6Class(
  'MessagesBase',
  public = list(
    `avatar_url` = NULL,
    `client` = NULL,
    `content` = NULL,
    `content_type` = NULL,
    `display_recipient` = NULL,
    `id` = NULL,
    `is_me_message` = NULL,
    `reactions` = NULL,
    `recipient_id` = NULL,
    `sender_email` = NULL,
    `sender_full_name` = NULL,
    `sender_id` = NULL,
    `sender_realm_str` = NULL,
    `stream_id` = NULL,
    `subject` = NULL,
    `topic_links` = NULL,
    `submessages` = NULL,
    `timestamp` = NULL,
    `type` = NULL,
    initialize = function(
        `avatar_url`=NULL, `client`=NULL, `content`=NULL, `content_type`=NULL, `display_recipient`=NULL, `id`=NULL, `is_me_message`=NULL, `reactions`=NULL, `recipient_id`=NULL, `sender_email`=NULL, `sender_full_name`=NULL, `sender_id`=NULL, `sender_realm_str`=NULL, `stream_id`=NULL, `subject`=NULL, `topic_links`=NULL, `submessages`=NULL, `timestamp`=NULL, `type`=NULL, ...
    ) {
      local.optional.var <- list(...)
      if (!is.null(`avatar_url`)) {
        stopifnot(is.character(`avatar_url`), length(`avatar_url`) == 1)
        self$`avatar_url` <- `avatar_url`
      }
      if (!is.null(`client`)) {
        stopifnot(is.character(`client`), length(`client`) == 1)
        self$`client` <- `client`
      }
      if (!is.null(`content`)) {
        stopifnot(is.character(`content`), length(`content`) == 1)
        self$`content` <- `content`
      }
      if (!is.null(`content_type`)) {
        stopifnot(is.character(`content_type`), length(`content_type`) == 1)
        self$`content_type` <- `content_type`
      }
      if (!is.null(`display_recipient`)) {
        stopifnot(R6::is.R6(`display_recipient`))
        self$`display_recipient` <- `display_recipient`
      }
      if (!is.null(`id`)) {
        stopifnot(is.numeric(`id`), length(`id`) == 1)
        self$`id` <- `id`
      }
      if (!is.null(`is_me_message`)) {
        stopifnot(is.logical(`is_me_message`), length(`is_me_message`) == 1)
        self$`is_me_message` <- `is_me_message`
      }
      if (!is.null(`reactions`)) {
        stopifnot(is.vector(`reactions`), length(`reactions`) != 0)
        sapply(`reactions`, function(x) stopifnot(R6::is.R6(x)))
        self$`reactions` <- `reactions`
      }
      if (!is.null(`recipient_id`)) {
        stopifnot(is.numeric(`recipient_id`), length(`recipient_id`) == 1)
        self$`recipient_id` <- `recipient_id`
      }
      if (!is.null(`sender_email`)) {
        stopifnot(is.character(`sender_email`), length(`sender_email`) == 1)
        self$`sender_email` <- `sender_email`
      }
      if (!is.null(`sender_full_name`)) {
        stopifnot(is.character(`sender_full_name`), length(`sender_full_name`) == 1)
        self$`sender_full_name` <- `sender_full_name`
      }
      if (!is.null(`sender_id`)) {
        stopifnot(is.numeric(`sender_id`), length(`sender_id`) == 1)
        self$`sender_id` <- `sender_id`
      }
      if (!is.null(`sender_realm_str`)) {
        stopifnot(is.character(`sender_realm_str`), length(`sender_realm_str`) == 1)
        self$`sender_realm_str` <- `sender_realm_str`
      }
      if (!is.null(`stream_id`)) {
        stopifnot(is.numeric(`stream_id`), length(`stream_id`) == 1)
        self$`stream_id` <- `stream_id`
      }
      if (!is.null(`subject`)) {
        stopifnot(is.character(`subject`), length(`subject`) == 1)
        self$`subject` <- `subject`
      }
      if (!is.null(`topic_links`)) {
        stopifnot(is.vector(`topic_links`), length(`topic_links`) != 0)
        sapply(`topic_links`, function(x) stopifnot(R6::is.R6(x)))
        self$`topic_links` <- `topic_links`
      }
      if (!is.null(`submessages`)) {
        stopifnot(is.vector(`submessages`), length(`submessages`) != 0)
        sapply(`submessages`, function(x) stopifnot(is.character(x)))
        self$`submessages` <- `submessages`
      }
      if (!is.null(`timestamp`)) {
        stopifnot(is.numeric(`timestamp`), length(`timestamp`) == 1)
        self$`timestamp` <- `timestamp`
      }
      if (!is.null(`type`)) {
        stopifnot(is.character(`type`), length(`type`) == 1)
        self$`type` <- `type`
      }
    },
    toJSON = function() {
      MessagesBaseObject <- list()
      if (!is.null(self$`avatar_url`)) {
        MessagesBaseObject[['avatar_url']] <-
          self$`avatar_url`
      }
      if (!is.null(self$`client`)) {
        MessagesBaseObject[['client']] <-
          self$`client`
      }
      if (!is.null(self$`content`)) {
        MessagesBaseObject[['content']] <-
          self$`content`
      }
      if (!is.null(self$`content_type`)) {
        MessagesBaseObject[['content_type']] <-
          self$`content_type`
      }
      if (!is.null(self$`display_recipient`)) {
        MessagesBaseObject[['display_recipient']] <-
          self$`display_recipient`$toJSON()
      }
      if (!is.null(self$`id`)) {
        MessagesBaseObject[['id']] <-
          self$`id`
      }
      if (!is.null(self$`is_me_message`)) {
        MessagesBaseObject[['is_me_message']] <-
          self$`is_me_message`
      }
      if (!is.null(self$`reactions`)) {
        MessagesBaseObject[['reactions']] <-
          lapply(self$`reactions`, function(x) x$toJSON())
      }
      if (!is.null(self$`recipient_id`)) {
        MessagesBaseObject[['recipient_id']] <-
          self$`recipient_id`
      }
      if (!is.null(self$`sender_email`)) {
        MessagesBaseObject[['sender_email']] <-
          self$`sender_email`
      }
      if (!is.null(self$`sender_full_name`)) {
        MessagesBaseObject[['sender_full_name']] <-
          self$`sender_full_name`
      }
      if (!is.null(self$`sender_id`)) {
        MessagesBaseObject[['sender_id']] <-
          self$`sender_id`
      }
      if (!is.null(self$`sender_realm_str`)) {
        MessagesBaseObject[['sender_realm_str']] <-
          self$`sender_realm_str`
      }
      if (!is.null(self$`stream_id`)) {
        MessagesBaseObject[['stream_id']] <-
          self$`stream_id`
      }
      if (!is.null(self$`subject`)) {
        MessagesBaseObject[['subject']] <-
          self$`subject`
      }
      if (!is.null(self$`topic_links`)) {
        MessagesBaseObject[['topic_links']] <-
          lapply(self$`topic_links`, function(x) x$toJSON())
      }
      if (!is.null(self$`submessages`)) {
        MessagesBaseObject[['submessages']] <-
          self$`submessages`
      }
      if (!is.null(self$`timestamp`)) {
        MessagesBaseObject[['timestamp']] <-
          self$`timestamp`
      }
      if (!is.null(self$`type`)) {
        MessagesBaseObject[['type']] <-
          self$`type`
      }

      MessagesBaseObject
    },
    fromJSON = function(MessagesBaseJson) {
      MessagesBaseObject <- jsonlite::fromJSON(MessagesBaseJson)
      if (!is.null(MessagesBaseObject$`avatar_url`)) {
        self$`avatar_url` <- MessagesBaseObject$`avatar_url`
      }
      if (!is.null(MessagesBaseObject$`client`)) {
        self$`client` <- MessagesBaseObject$`client`
      }
      if (!is.null(MessagesBaseObject$`content`)) {
        self$`content` <- MessagesBaseObject$`content`
      }
      if (!is.null(MessagesBaseObject$`content_type`)) {
        self$`content_type` <- MessagesBaseObject$`content_type`
      }
      if (!is.null(MessagesBaseObject$`display_recipient`)) {
        display_recipientObject <- OneOfstringarray$new()
        display_recipientObject$fromJSON(jsonlite::toJSON(MessagesBaseObject$display_recipient, auto_unbox = TRUE, digits = NA))
        self$`display_recipient` <- display_recipientObject
      }
      if (!is.null(MessagesBaseObject$`id`)) {
        self$`id` <- MessagesBaseObject$`id`
      }
      if (!is.null(MessagesBaseObject$`is_me_message`)) {
        self$`is_me_message` <- MessagesBaseObject$`is_me_message`
      }
      if (!is.null(MessagesBaseObject$`reactions`)) {
        self$`reactions` <- ApiClient$new()$deserializeObj(MessagesBaseObject$`reactions`, "array[EmojiReaction]", loadNamespace("openapi"))
      }
      if (!is.null(MessagesBaseObject$`recipient_id`)) {
        self$`recipient_id` <- MessagesBaseObject$`recipient_id`
      }
      if (!is.null(MessagesBaseObject$`sender_email`)) {
        self$`sender_email` <- MessagesBaseObject$`sender_email`
      }
      if (!is.null(MessagesBaseObject$`sender_full_name`)) {
        self$`sender_full_name` <- MessagesBaseObject$`sender_full_name`
      }
      if (!is.null(MessagesBaseObject$`sender_id`)) {
        self$`sender_id` <- MessagesBaseObject$`sender_id`
      }
      if (!is.null(MessagesBaseObject$`sender_realm_str`)) {
        self$`sender_realm_str` <- MessagesBaseObject$`sender_realm_str`
      }
      if (!is.null(MessagesBaseObject$`stream_id`)) {
        self$`stream_id` <- MessagesBaseObject$`stream_id`
      }
      if (!is.null(MessagesBaseObject$`subject`)) {
        self$`subject` <- MessagesBaseObject$`subject`
      }
      if (!is.null(MessagesBaseObject$`topic_links`)) {
        self$`topic_links` <- ApiClient$new()$deserializeObj(MessagesBaseObject$`topic_links`, "array[MessagesBaseTopicLinks]", loadNamespace("openapi"))
      }
      if (!is.null(MessagesBaseObject$`submessages`)) {
        self$`submessages` <- ApiClient$new()$deserializeObj(MessagesBaseObject$`submessages`, "array[character]", loadNamespace("openapi"))
      }
      if (!is.null(MessagesBaseObject$`timestamp`)) {
        self$`timestamp` <- MessagesBaseObject$`timestamp`
      }
      if (!is.null(MessagesBaseObject$`type`)) {
        self$`type` <- MessagesBaseObject$`type`
      }
      self
    },
    toJSONString = function() {
      jsoncontent <- c(
        if (!is.null(self$`avatar_url`)) {
        sprintf(
        '"avatar_url":
          "%s"
                ',
        self$`avatar_url`
        )},
        if (!is.null(self$`client`)) {
        sprintf(
        '"client":
          "%s"
                ',
        self$`client`
        )},
        if (!is.null(self$`content`)) {
        sprintf(
        '"content":
          "%s"
                ',
        self$`content`
        )},
        if (!is.null(self$`content_type`)) {
        sprintf(
        '"content_type":
          "%s"
                ',
        self$`content_type`
        )},
        if (!is.null(self$`display_recipient`)) {
        sprintf(
        '"display_recipient":
        %s
        ',
        jsonlite::toJSON(self$`display_recipient`$toJSON(), auto_unbox=TRUE, digits = NA)
        )},
        if (!is.null(self$`id`)) {
        sprintf(
        '"id":
          %d
                ',
        self$`id`
        )},
        if (!is.null(self$`is_me_message`)) {
        sprintf(
        '"is_me_message":
          %s
                ',
        tolower(self$`is_me_message`)
        )},
        if (!is.null(self$`reactions`)) {
        sprintf(
        '"reactions":
        [%s]
',
        paste(sapply(self$`reactions`, function(x) jsonlite::toJSON(x$toJSON(), auto_unbox=TRUE, digits = NA)), collapse=",")
        )},
        if (!is.null(self$`recipient_id`)) {
        sprintf(
        '"recipient_id":
          %d
                ',
        self$`recipient_id`
        )},
        if (!is.null(self$`sender_email`)) {
        sprintf(
        '"sender_email":
          "%s"
                ',
        self$`sender_email`
        )},
        if (!is.null(self$`sender_full_name`)) {
        sprintf(
        '"sender_full_name":
          "%s"
                ',
        self$`sender_full_name`
        )},
        if (!is.null(self$`sender_id`)) {
        sprintf(
        '"sender_id":
          %d
                ',
        self$`sender_id`
        )},
        if (!is.null(self$`sender_realm_str`)) {
        sprintf(
        '"sender_realm_str":
          "%s"
                ',
        self$`sender_realm_str`
        )},
        if (!is.null(self$`stream_id`)) {
        sprintf(
        '"stream_id":
          %d
                ',
        self$`stream_id`
        )},
        if (!is.null(self$`subject`)) {
        sprintf(
        '"subject":
          "%s"
                ',
        self$`subject`
        )},
        if (!is.null(self$`topic_links`)) {
        sprintf(
        '"topic_links":
        [%s]
',
        paste(sapply(self$`topic_links`, function(x) jsonlite::toJSON(x$toJSON(), auto_unbox=TRUE, digits = NA)), collapse=",")
        )},
        if (!is.null(self$`submessages`)) {
        sprintf(
        '"submessages":
           [%s]
        ',
        paste(unlist(lapply(self$`submessages`, function(x) paste0('"', x, '"'))), collapse=",")
        )},
        if (!is.null(self$`timestamp`)) {
        sprintf(
        '"timestamp":
          %d
                ',
        self$`timestamp`
        )},
        if (!is.null(self$`type`)) {
        sprintf(
        '"type":
          "%s"
                ',
        self$`type`
        )}
      )
      jsoncontent <- paste(jsoncontent, collapse = ",")
      paste('{', jsoncontent, '}', sep = "")
    },
    fromJSONString = function(MessagesBaseJson) {
      MessagesBaseObject <- jsonlite::fromJSON(MessagesBaseJson)
      self$`avatar_url` <- MessagesBaseObject$`avatar_url`
      self$`client` <- MessagesBaseObject$`client`
      self$`content` <- MessagesBaseObject$`content`
      self$`content_type` <- MessagesBaseObject$`content_type`
      self$`display_recipient` <- OneOfstringarray$new()$fromJSON(jsonlite::toJSON(MessagesBaseObject$display_recipient, auto_unbox = TRUE, digits = NA))
      self$`id` <- MessagesBaseObject$`id`
      self$`is_me_message` <- MessagesBaseObject$`is_me_message`
      self$`reactions` <- ApiClient$new()$deserializeObj(MessagesBaseObject$`reactions`, "array[EmojiReaction]", loadNamespace("openapi"))
      self$`recipient_id` <- MessagesBaseObject$`recipient_id`
      self$`sender_email` <- MessagesBaseObject$`sender_email`
      self$`sender_full_name` <- MessagesBaseObject$`sender_full_name`
      self$`sender_id` <- MessagesBaseObject$`sender_id`
      self$`sender_realm_str` <- MessagesBaseObject$`sender_realm_str`
      self$`stream_id` <- MessagesBaseObject$`stream_id`
      self$`subject` <- MessagesBaseObject$`subject`
      self$`topic_links` <- ApiClient$new()$deserializeObj(MessagesBaseObject$`topic_links`, "array[MessagesBaseTopicLinks]", loadNamespace("openapi"))
      self$`submessages` <- ApiClient$new()$deserializeObj(MessagesBaseObject$`submessages`, "array[character]", loadNamespace("openapi"))
      self$`timestamp` <- MessagesBaseObject$`timestamp`
      self$`type` <- MessagesBaseObject$`type`
      self
    }
  )
)
